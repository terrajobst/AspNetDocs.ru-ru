---
uid: web-forms/overview/ajax-control-toolkit/getting-started/creating-a-custom-ajax-control-toolkit-control-extender-vb
title: Создание пользовательского расширителя элемента управления AJAX Control Toolkit (VB) | Документация Майкрософт
author: microsoft
description: Пользовательские расширители позволяют настраивать и расширять возможности элементов управления ASP.NET, не создавая новые классы.
ms.author: riande
ms.date: 05/12/2009
ms.assetid: 18b29834-c991-4e0c-b533-44d358fbfc9c
msc.legacyurl: /web-forms/overview/ajax-control-toolkit/getting-started/creating-a-custom-ajax-control-toolkit-control-extender-vb
msc.type: authoredcontent
ms.openlocfilehash: 0849fa6c13679e0cd01bb20a4067a097acbce298
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/06/2020
ms.locfileid: "78466866"
---
# <a name="creating-a-custom-ajax-control-toolkit-control-extender-vb"></a>Создание пользовательского управляющего элемента-расширителя для набора элементов управления AJAX (VB)

по [Майкрософт](https://github.com/microsoft)

> Пользовательские расширители позволяют настраивать и расширять возможности элементов управления ASP.NET, не создавая новые классы.

В этом руководстве вы узнаете, как создать специализированный расширитель элемента управления AJAX Control Toolkit. Мы создаем простой, но полезный, новый расширитель, который изменяет состояние кнопки с отключенного на включено при вводе текста в текстовое поле. После прочтения этого руководства вы сможете расширить набор средств ASP.NET AJAX Toolkit с помощью собственных расширителей элементов управления.

Вы можете создавать расширители пользовательских элементов управления с помощью Visual Studio или Visual Web Developer (убедитесь, что у вас установлена последняя версия Visual Web Developer).

## <a name="overview-of-the-disabledbutton-extender"></a>Обзор расширителя Дисабледбуттон

Наш новый расширитель элемента управления называется расширитель Дисабледбуттон. Этот расширитель будет иметь три свойства:

- TargetControlID — текстовое поле, расширяющее элемент управления.
- Таржетбуттониид — отключенная или включенная кнопка.
- Дисабледтекст — текст, первоначально отображаемый на кнопке. Когда вы начинаете вводить текст, Кнопка отображает значение свойства Text кнопки.

Расширитель Дисабледбуттон можно подключить к элементу управления TextBox и кнопке. Перед вводом какого-либо текста кнопка будет отключена, а текстовое поле и кнопка будут выглядеть следующим образом:

[![](creating-a-custom-ajax-control-toolkit-control-extender-vb/_static/image2.png)](creating-a-custom-ajax-control-toolkit-control-extender-vb/_static/image1.png)

([Щелкните, чтобы просмотреть изображение с полным размером](creating-a-custom-ajax-control-toolkit-control-extender-vb/_static/image3.png))

После начала ввода текста кнопка будет включена, а текстовое поле и кнопка будут выглядеть следующим образом:

[![](creating-a-custom-ajax-control-toolkit-control-extender-vb/_static/image5.png)](creating-a-custom-ajax-control-toolkit-control-extender-vb/_static/image4.png)

([Щелкните, чтобы просмотреть изображение с полным размером](creating-a-custom-ajax-control-toolkit-control-extender-vb/_static/image6.png))

Чтобы создать расширитель элемента управления, необходимо создать следующие три файла:

- Дисабледбуттонекстендер. vb — этот файл является классом элемента управления на стороне сервера, который будет управлять созданием расширителя и позволяет задавать свойства во время разработки. Он также определяет свойства, которые можно задать для расширителя. Эти свойства доступны через код и во время разработки и соответствуют свойствам, определенным в файле Дисаблебуттонбехавиор. js.
- Дисабледбуттонбехавиор. js — в этом файле будет добавлена вся логика клиентского скрипта.
- Дисабледбуттондесигнер. vb — этот класс включает функции времени разработки. Этот класс необходим, если требуется, чтобы расширитель элемента управления правильно работал с конструктором Visual Studio или Visual Web Developer.

Таким образом, расширитель элемента управления состоит из элемента управления на стороне сервера, поведения на стороне клиента и класса конструктора на стороне сервера. Вы научитесь создавать все три файла в следующих разделах.

## <a name="creating-the-custom-extender-website-and-project"></a>Создание пользовательского веб-сайта расширителя и проекта

Первым шагом является создание проекта библиотеки классов и веб-сайта в Visual Studio или Visual Web Developer. Мы создадим пользовательский расширитель в проекте библиотеки классов и тестируем пользовательский расширитель на веб-сайте.

Давайте начнем с веб-сайта. Чтобы создать веб-сайт, выполните следующие действия.

1. Выберите файл параметров меню **, новый веб-сайт**.
2. Выберите шаблон **веб-сайт ASP.NET** .
3. Назовите новый веб-сайт *Website1*.
4. Нажмите кнопку **ОК** .

Далее необходимо создать проект библиотеки классов, который будет содержать код для расширителя элемента управления:

1. Выберите файл параметров меню **, добавить, новый проект**.
2. Выберите шаблон **Библиотека классов** .
3. Присвойте новой библиотеке классов имя **кустомекстендерс**.
4. Нажмите кнопку **ОК** .

После выполнения этих действий окно обозреватель решений должно выглядеть, как показано на рис. 1.

[![решение с веб-сайтом и проектом библиотеки классов](creating-a-custom-ajax-control-toolkit-control-extender-vb/_static/image8.png)](creating-a-custom-ajax-control-toolkit-control-extender-vb/_static/image7.png)

**Рис. 01**. решение с проектом веб-сайта и библиотеки классов ([щелкните, чтобы просмотреть изображение с полным размером](creating-a-custom-ajax-control-toolkit-control-extender-vb/_static/image9.png))

Далее необходимо добавить все необходимые ссылки на сборки в проект библиотеки классов.

1. Щелкните правой кнопкой мыши проект Кустомекстендерс и выберите пункт меню **Добавить ссылку**.
2. Выберите вкладку .NET.
3. Добавьте ссылки на следующие сборки:

    1. System.Web.dll.
    2. System.Web.Extensions.dll.
    3. System.Design.dll
    4. System. Web. Extensions. Design. dll
4. Перейдите на вкладку Обзор.
5. Добавьте ссылку на сборку Ажаксконтролтулкит. dll. Эта сборка находится в папке, в которую был скачан набор средств AJAX Control Toolkit.

Вы можете убедиться, что добавлены все нужные ссылки, щелкнув правой кнопкой мыши проект, выбрав пункт Свойства и перейдя на вкладку ссылки (см. рис. 2).

[![папки ссылок с необходимыми ссылками](creating-a-custom-ajax-control-toolkit-control-extender-vb/_static/image11.png)](creating-a-custom-ajax-control-toolkit-control-extender-vb/_static/image10.png)

**Рис. 02**. ссылки на папку с необходимыми ссылками ([щелкните, чтобы просмотреть изображение с полным размером](creating-a-custom-ajax-control-toolkit-control-extender-vb/_static/image12.png))

## <a name="creating-the-custom-control-extender"></a>Создание расширителя пользовательского элемента управления

Теперь, когда у нас есть наша библиотека классов, мы можем приступить к созданию нашего расширяющего элемента управления. Начнем с начальных костей пользовательского класса элемента управления расширителя (см. листинг 1).

**Листинг 1-Микустомекстендер. vb**

[!code-vb[Main](creating-a-custom-ajax-control-toolkit-control-extender-vb/samples/sample1.vb)]

В листинге 1 есть несколько вещей, которые можно заметить о классе расширителя элемента управления. Во первых, обратите внимание, что класс наследуется от базового класса Екстендерконтролбасе. Все элементы управления расширителем набора средств AJAX Control являются производными от этого базового класса. Например, базовый класс включает свойство TargetID, которое является обязательным свойством каждого расширителя элемента управления.

Далее обратите внимание, что класс включает следующие два атрибута, связанные с клиентским скриптом:

- В этом случае файл добавляется в сборку в качестве внедренного ресурса.
- Клиентскриптресаурце — вызывает получение ресурса скрипта из сборки.

Атрибут "объект" используется для внедрения файла JavaScript Миконтролбехавиор. js в сборку при компиляции пользовательского расширителя. Атрибут Клиентскриптресаурце используется для получения скрипта Миконтролбехавиор. js из сборки, когда пользовательский расширитель используется на веб-странице.

Чтобы атрибуты "Клиентскриптресаурце" и "Рабочий" могли работать, необходимо скомпилировать файл JavaScript как внедренный ресурс. Выберите файл в окне обозреватель решений, откройте страницу свойств и назначьте свойству **действие сборки** значение *внедренный ресурс* .

Обратите внимание, что расширитель элемента управления также включает атрибут Таржетконтролтипе. Этот атрибут используется для указания типа элемента управления, который расширяется расширителем элемента управления. В случае листинга 1 расширитель элемента управления используется для расширения текстового поля.

Наконец, обратите внимание, что пользовательский расширитель включает свойство с именем MyProperty. Свойство помечено атрибутом Екстендерконтролпроперти. Методы Жетпропертивалуе () и Сетпропертивалуе () используются для передачи значения свойства из расширителя серверного элемента управления в поведение на стороне клиента.

Давайте добавим код для нашего расширителя Дисабледбуттон. Код для этого расширителя можно найти в листинге 2.

**Листинг 2-Дисабледбуттонекстендер. vb**

[!code-vb[Main](creating-a-custom-ajax-control-toolkit-control-extender-vb/samples/sample2.vb)]

Расширитель Дисабледбуттон в листинге 2 имеет два свойства с именами Таржетбуттонид и Дисабледтекст. Идреференцепроперти, применяемый к свойству Таржетбуттонид, не позволяет назначить этому свойству ничего, кроме идентификатора элемента управления "Кнопка".

Атрибуты WebClient и Клиентскриптресаурце связывают поведение на стороне клиента, расположенное в файле с именем Дисабледбуттонбехавиор. js, с этим расширителем. Этот файл JavaScript обсуждается в следующем разделе.

## <a name="creating-the-custom-extender-behavior"></a>Создание пользовательского поведения расширителя

Клиентский компонент расширителя элемента управления называется поведением. Реальная логика для отключения и включения кнопки содержится в поведении Дисабледбуттон. Код JavaScript для поведения включен в листинг 3.

**Листинг 3 — Дисабледбуттон. js**

[!code-javascript[Main](creating-a-custom-ajax-control-toolkit-control-extender-vb/samples/sample3.js)]

Файл JavaScript в листинге 3 содержит класс на стороне клиента с именем Дисабледбуттонбехавиор. Этот класс, как и двойника на стороне сервера, включает два свойства с именами Таржетбуттонид и Дисабледтекст, к которым можно получить доступ с помощью Get\_Таржетбуттонид/Set\_Таржетбуттонид и Get\_Дисабледтекст/Set\_Дисабледтекст.

Метод Initialize () связывает обработчик событий KeyUp с целевым элементом для поведения. Каждый раз при вводе буквы в текстовое поле, связанное с этим поведением, выполняется обработчик KeyUp. Обработчик KeyUp либо включает, либо отключает кнопку в зависимости от того, содержит ли текстовое поле, связанное с поведением, любой текст.

Помните, что файл JavaScript необходимо скомпилировать в листинг 3 как внедренный ресурс. Выберите файл в окне обозреватель решений, откройте страницу свойств и назначьте свойству **действие сборки** значение *внедренный ресурс* (см. рис. 3). Этот параметр доступен как в Visual Studio, так и в Visual Web Developer.

[![Добавление файла JavaScript в качестве внедренного ресурса](creating-a-custom-ajax-control-toolkit-control-extender-vb/_static/image14.png)](creating-a-custom-ajax-control-toolkit-control-extender-vb/_static/image13.png)

**Рис. 03**. Добавление файла JavaScript в качестве внедренного ресурса ([щелкните, чтобы просмотреть изображение с полным размером](creating-a-custom-ajax-control-toolkit-control-extender-vb/_static/image15.png))

## <a name="creating-the-custom-extender-designer"></a>Создание пользовательского конструктора расширителей

Существует один последний класс, который необходимо создать для завершения нашего расширителя. Необходимо создать класс конструктора в листинге 4. Этот класс необходим для правильного поведения расширения в конструкторе Visual Studio или Visual Web Developer.

**Листинг 4-Дисабледбуттондесигнер. vb**

[!code-vb[Main](creating-a-custom-ajax-control-toolkit-control-extender-vb/samples/sample4.vb)]

Вы связываете конструктор в листинге 4 с расширением Дисабледбуттон с атрибутом конструктора. Необходимо применить атрибут конструктора к классу Дисабледбуттонекстендер следующим образом:

[!code-vb[Main](creating-a-custom-ajax-control-toolkit-control-extender-vb/samples/sample5.vb)]

## <a name="using-the-custom-extender"></a>Использование пользовательского расширителя

Теперь, когда мы завершили создание расширителя элемента управления Дисабледбуттон, пора его использовать на нашем веб-сайте ASP.NET. Сначала необходимо добавить пользовательский расширитель к панели элементов. Выполните следующие действия.

1. Откройте страницу ASP.NET, дважды щелкнув страницу в окне обозреватель решений.
2. Щелкните правой кнопкой мыши панель элементов и выберите пункт меню **элементы**.
3. В диалоговом окне Выбор элементов панели элементов перейдите к сборке Кустомекстендерс. dll.
4. Нажмите кнопку **ОК** , чтобы закрыть диалоговое окно.

После выполнения этих действий на панели элементов должен появиться расширитель элемента управления Дисабледбуттон (см. рис. 4).

[![Дисабледбуттон на панели элементов](creating-a-custom-ajax-control-toolkit-control-extender-vb/_static/image17.png)](creating-a-custom-ajax-control-toolkit-control-extender-vb/_static/image16.png)

**Рис. 04**. дисабледбуттон на панели элементов ([щелкните, чтобы просмотреть изображение с полным размером](creating-a-custom-ajax-control-toolkit-control-extender-vb/_static/image18.png))

Затем нужно создать новую страницу ASP.NET. Выполните следующие действия.

1. Создайте новую страницу ASP.NET с именем Шовдисабледбуттон. aspx.
2. Перетащите ScriptManager на страницу.
3. Перетащите элемент управления TextBox на страницу.
4. Перетащите элемент управления Button на страницу.
5. В окно свойств измените свойство идентификатора кнопки на значение <em>бтнсаве</em> , а для свойства Text — на значение *сохранить\** .

Мы создали страницу со стандартным текстовым полем ASP.NET и элементом управления Button.

Далее необходимо расширить элемент управления TextBox с помощью расширителя Дисабледбуттон:

1. Выберите параметр **Добавить задачу расширения** , чтобы открыть диалоговое окно мастера расширения (см. рис. 5). Обратите внимание, что в диалоговом окне есть пользовательский расширитель Дисабледбуттон.
2. Выберите расширитель Дисабледбуттон и нажмите кнопку **ОК** .

[![диалогового окна мастера расширения](creating-a-custom-ajax-control-toolkit-control-extender-vb/_static/image20.png)](creating-a-custom-ajax-control-toolkit-control-extender-vb/_static/image19.png)

**Рис. 05**. диалоговое окно мастера расширения ([щелкните, чтобы просмотреть изображение с полным размером](creating-a-custom-ajax-control-toolkit-control-extender-vb/_static/image21.png))

Наконец, можно задать свойства расширителя Дисабледбуттон. Свойства расширителя Дисабледбуттон можно изменить, изменив свойства элемента управления TextBox:

1. Выберите текстовое поле в конструкторе.
2. В окно свойств разверните узел расширители (см. рис. 6).
3. Присвойте значение *Save* свойству дисабледтекст, а значение *бтнсаве* — свойству таржетбуттонид.

[Настройка свойств расширителя ![](creating-a-custom-ajax-control-toolkit-control-extender-vb/_static/image23.png)](creating-a-custom-ajax-control-toolkit-control-extender-vb/_static/image22.png)

**Рис. 06**. Задание свойств расширителя ([щелкните, чтобы просмотреть изображение с полным размером](creating-a-custom-ajax-control-toolkit-control-extender-vb/_static/image24.png))

При запуске страницы (нажатием клавиши F5) элемент управления "Кнопка" изначально отключен. Как только вы начнете вводить текст в текстовое поле, элемент управления "Кнопка" будет включен (см. рис. 7).

[![расширитель Дисабледбуттон в действии](creating-a-custom-ajax-control-toolkit-control-extender-vb/_static/image26.png)](creating-a-custom-ajax-control-toolkit-control-extender-vb/_static/image25.png)

**Рис. 07**. расширитель дисабледбуттон в действии ([щелкните, чтобы просмотреть изображение с полным размером](creating-a-custom-ajax-control-toolkit-control-extender-vb/_static/image27.png))

## <a name="summary"></a>Сводка

Цель этого учебника — объяснить, как можно расширить набор средств AJAX Control Toolkit с помощью пользовательских элементов управления расширителем. В этом руководстве мы создали простой расширитель элемента управления Дисабледбуттон. Мы реализовали этот расширитель, создав класс Дисабледбуттонекстендер, поведение Дисабледбуттонбехавиор JavaScript и класс Дисабледбуттондесигнер. При создании расширителя пользовательского элемента управления необходимо выполнить аналогичный набор действий.

> [!div class="step-by-step"]
> [Назад](using-ajax-control-toolkit-controls-and-control-extenders-vb.md)
